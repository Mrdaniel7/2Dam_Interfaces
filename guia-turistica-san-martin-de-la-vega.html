<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><title>Guia Turistica San Martin De La Vega - Proceso de aplicaciones</title><meta name="description" content="Link aplicaci√≥n üëâ Gu√≠a Tur√≠stica de San Mart√≠n de la Vega Cambia la URL cuando tengas publicado el proyecto (o pon el dominio&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="./guia-turistica-san-martin-de-la-vega.html"><link rel="stylesheet" href="./assets/css/fontawesome-all.min.css?v=85514f933f9e0b82460af63f1a403fa5"><link rel="stylesheet" href="./assets/css/style.css?v=a43d11e6c8e1828dd0b983b73b3cdb13"><noscript><link rel="stylesheet" href="./assets/css/noscript.css?v=efa867a99f5064d6729e4dc2008ad50b"></noscript><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"./guia-turistica-san-martin-de-la-vega.html"},"headline":"Guia Turistica San Martin De La Vega","datePublished":"2025-11-12T23:49+01:00","dateModified":"2025-11-20T14:31+01:00","description":"Link aplicaci√≥n üëâ Gu√≠a Tur√≠stica de San Mart√≠n de la Vega Cambia la URL cuando tengas publicado el proyecto (o pon el dominio&hellip;","author":{"@type":"Person","name":"Daniel Terroba Alcal√°","url":"./authors/daniel-terroba-alcala/"},"publisher":{"@type":"Organization","name":"Daniel Terroba Alcal√°"}}</script><style>#wrapper > .bg {
               background-image: url(./assets/images/overlay.png), linear-gradient(0deg, rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.1)), url();
           }</style><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body class="is-preload page-template"><div id="wrapper"><header id="header"><a class="logo" href="./">Proceso de aplicaciones</a></header><nav id="nav"><ul class="links"><li><a href="./pomodoro-creciente.html" target="_self">Pomodoro viviente</a></li><li><a href="./calendario-multimedia.html" target="_self">Calendario Multimedia</a></li><li class="active"><a href="./guia-turistica-san-martin-de-la-vega.html" target="_self">Turismo San Martin de la Vega</a></li><li><a href="./clonar-listen-ai.html" target="_self">Listen Ai</a></li></ul></nav><main id="main"><article class="post"><header class="major"><h1>Guia Turistica San Martin De La Vega</h1><p class="post__inner"></p></header><div class="post__inner post__entry"><div class="post__toc"><h3>√çndice</h3><ul><li><a href="#link-app">Link aplicaci√≥n</a></li><li><a href="#v1-5">1. Versiones 1‚Äì5 (rese√±as y valoraci√≥n b√°sica)</a><ul><li><a href="#v1-5-prompts">1.1 Resumen de prompts</a></li><li><a href="#v1-5-img">1.2 Imagen del resultado</a></li></ul></li><li><a href="#v6-15">2. Versiones 6‚Äì15 (experiencia visual de rese√±as)</a><ul><li><a href="#v6-15-prompts">2.1 Resumen de prompts</a></li><li><a href="#v6-15-img">2.2 Imagen del resultado</a></li></ul></li><li><a href="#v16-30">3. Versiones 16‚Äì30 (timestamps e im√°genes en Storage)</a><ul><li><a href="#v16-30-prompts">3.1 Resumen de prompts</a></li><li><a href="#v16-30-img">3.2 Imagen del resultado</a></li></ul></li><li><a href="#v31-40">4. Versiones 31‚Äì40 (autenticaci√≥n ‚Äì base)</a><ul><li><a href="#v31-40-prompts">4.1 Resumen de prompts</a></li><li><a href="#v31-40-img">4.2 Imagen del resultado</a></li></ul></li><li><a href="#v41-48">5. Versiones 41‚Äì48+ (autenticaci√≥n ‚Äì avanzado y pulido)</a><ul><li><a href="#v41-48-prompts">5.1 Resumen de prompts</a></li><li><a href="#v41-48-img">5.2 Imagen del resultado</a></li></ul></li></ul></div><h1 id="link-app">Link aplicaci√≥n</h1><p style="font-size: 20px; margin: 8px 0;">üëâ <a href="#" target="_blank" rel="noopener">Gu√≠a Tur√≠stica de San Mart√≠n de la Vega</a></p><p class="hint">Cambia la URL cuando tengas publicado el proyecto (o pon el dominio que ya uses).</p><h1 id="v1-5">1. Versiones 1‚Äì5: rese√±as que por fin se ven</h1><h2 id="v1-5-prompts">1.1 Resumen de prompts (natural y directo)</h2><div class="cm-block"><ul class="cm-list"><li>Arreglo de la l√≥gica que filtraba las rese√±as al pintar los sitios: ahora se muestran las que est√°n <strong>aprobadas / publicadas</strong> sin depender de moderacionCompletada.</li><li>Simplificaci√≥n de la condici√≥n para que una rese√±a sea visible y a√±adido de <strong>logs de depuraci√≥n</strong> para ver en consola rese√±as crudas vs. rese√±as finales.</li><li>Documentaci√≥n de los campos de imagen que realmente llegan desde Firestore (<code>imagen</code>, <code>imagenPrincipal</code>, <code>galeria</code>, etc.) y unificaci√≥n de la forma de pintarlos.</li><li>C√°lculo de la <strong>media de estrellas</strong> a partir de rese√±as aprobadas/publicadas y actualizaci√≥n de las tarjetas de lugares con esa media y el n√∫mero total de rese√±as.</li><li>Cambio del modelo de NSFWJS a una URL bajo control propio, con manejo de errores m√°s robusto para evitar ruido en consola cuando falle el modelo.</li></ul><p style="margin-top: 10px;"><span class="cm-pill">Rese√±as visibles</span> <span class="cm-pill">Filtros simplificados</span> <span class="cm-pill">Logs en consola</span> <span class="cm-pill">Media de estrellas</span> <span class="cm-pill">Modelo NSFWJS propio</span></p></div><h2 id="v1-5-img">1.2 Imagen del resultado</h2><p class="cm-caption">Las rese√±as y sus valoraciones aparecen ya en las fichas de cada sitio y en los listados, con medias de estrellas consistentes.</p><figure class="post__image"><img loading="lazy" src="./media/posts/7/1-turismo.png" alt="" width="2548" height="1267" sizes="(max-width: 48em) 100vw, 768px" srcset="./media/posts/7/responsive/1-turismo-xs.png 300w, ./media/posts/7/responsive/1-turismo-sm.png 480w, ./media/posts/7/responsive/1-turismo-md.png 768w, ./media/posts/7/responsive/1-turismo-lg.png 1024w, ./media/posts/7/responsive/1-turismo-xl.png 1360w, ./media/posts/7/responsive/1-turismo-2xl.png 1600w"></figure><h1 id="v6-15">2. Versiones 6‚Äì15: experiencia visual de rese√±as e ideas destacadas</h1><h2 id="v6-15-prompts">2.1 Resumen de prompts</h2><div class="cm-block"><ul class="cm-list"><li>Dise√±o de un <strong>lightbox / pop-up</strong> para im√°genes de rese√±as: al hacer clic en una miniatura, se abre un overlay centrado con la foto grande.</li><li>Navegaci√≥n dentro del lightbox con <strong>flechas izquierda/derecha</strong> y bot√≥n de cierre con una <strong>X</strong> en la esquina, bloqueando el scroll del fondo mientras est√° abierto.</li><li>Reutilizaci√≥n de las mismas URLs de imagen ya resueltas (Storage o HTTPS) para no recalcular rutas dentro del lightbox.</li><li>Mejora del widget de sitios con m√°s de 4 estrellas en la p√°gina de inicio: truncar la descripci√≥n (‚âà300 caracteres en escritorio y ‚âà100 en m√≥vil) y a√±adir puntos suspensivos.</li><li>Foco en que las tarjetas destacadas sean m√°s <strong>limpias y legibles</strong>, destacando nombre, imagen y valoraci√≥n del lugar.</li></ul><p style="margin-top: 10px;"><span class="cm-pill">Lightbox rese√±as</span> <span class="cm-pill">Navegaci√≥n entre fotos</span> <span class="cm-pill">Scroll bloqueado</span> <span class="cm-pill">Sitios &gt; 4 estrellas</span> <span class="cm-pill">Textos truncados</span></p></div><h2 id="v6-15-img">2.2 Imagen del resultado</h2><p class="cm-caption">Las im√°genes de las rese√±as se abren en un pop-up c√≥modo y las tarjetas de sitios destacados son m√°s legibles tanto en m√≥vil como en escritorio.</p><h1 id="v16-30">3. Versiones 16‚Äì30: timestamps e im√°genes en Firebase Storage</h1><h2 id="v16-30-prompts">3.1 Resumen de prompts</h2><div class="cm-block"><ul class="cm-list"><li>Mejora del flujo de env√≠o de rese√±as para tener <strong>trazabilidad</strong> y mejor depuraci√≥n: registro autom√°tico de <code>createdAt</code> y <code>updatedAt</code> con <code>serverTimestamp()</code>.</li><li>Construcci√≥n del payload en una variable intermedia (<code>resenaData</code>) antes de crear el documento en Firestore y logs claros antes y despu√©s de la escritura.</li><li>Manejo expl√≠cito del error <code>permission-denied</code> con feedback amigable cuando el usuario no tiene permisos para publicar rese√±as.</li><li>Migraci√≥n del campo de imagen: se deja de guardar la imagen completa en Firestore para evitar superar el l√≠mite de 1 MB por documento.</li><li>Nuevo flujo con <strong>Firebase Storage</strong>: primero se sube el archivo a una ruta tipo <code>lugares/{idLugar}/{nombreArchivo}</code>, luego se obtiene la URL con <code>getDownloadURL()</code> y solo se guarda la URL en Firestore.</li><li>Recomendaci√≥n de validar en el cliente el tama√±o m√°ximo de archivo (por ejemplo, &lt; 800 KB) y documentaci√≥n de posibles bloqueos por extensiones tipo adblocker.</li></ul><p style="margin-top: 10px;"><span class="cm-pill">Trazabilidad de rese√±as</span> <span class="cm-pill">serverTimestamp()</span> <span class="cm-pill">Manejo de permisos</span> <span class="cm-pill">Firebase Storage</span> <span class="cm-pill">Validaci√≥n de tama√±o</span></p></div><h2 id="v16-30-img">3.2 Imagen del resultado</h2><p class="cm-caption">El sistema de rese√±as queda m√°s robusto: las im√°genes se sirven desde Storage y cada rese√±a tiene fechas claras de creaci√≥n y actualizaci√≥n.</p><figure class="post__image"><img loading="lazy" src="./media/posts/7/2-turismo.png" alt="" width="2529" height="1273" sizes="(max-width: 48em) 100vw, 768px" srcset="./media/posts/7/responsive/2-turismo-xs.png 300w, ./media/posts/7/responsive/2-turismo-sm.png 480w, ./media/posts/7/responsive/2-turismo-md.png 768w, ./media/posts/7/responsive/2-turismo-lg.png 1024w, ./media/posts/7/responsive/2-turismo-xl.png 1360w, ./media/posts/7/responsive/2-turismo-2xl.png 1600w"></figure><h1 id="v31-40">4. Versiones 31‚Äì40: autenticaci√≥n ‚Äì base s√≥lida</h1><h2 id="v31-40-prompts">4.1 Resumen de prompts</h2><div class="cm-block"><ul class="cm-list"><li>Eliminaci√≥n de <code>ADMIN_EMAILS</code> del cliente y migraci√≥n a un modelo basado solo en <strong>Custom Claims</strong> de Firebase para controlar el rol de administrador.</li><li>Documentaci√≥n de que los Custom Claims se gestionan desde Firebase Admin SDK o Cloud Functions y no desde el frontend.</li><li>Pantalla de login mejorada: validaci√≥n en tiempo real, detecci√≥n de cuenta existente y opci√≥n de mostrar/ocultar contrase√±a con icono accesible.</li><li>Creaci√≥n de un formulario de registro con doble contrase√±a, nombre para mostrar opcional y manejo de errores de Firebase Auth.</li><li>Flujo de recuperaci√≥n de contrase√±a usando <code>sendPasswordResetEmail</code> y l√≠mite de intentos.</li><li>Detecci√≥n de si el email est√° verificado, mostrando un banner persistente cuando no lo est√° y restringiendo acciones sensibles (rese√±as, panel admin) a cuentas verificadas.</li></ul><p style="margin-top: 10px;"><span class="cm-pill">Custom Claims</span> <span class="cm-pill">Login mejorado</span> <span class="cm-pill">Registro completo</span> <span class="cm-pill">Reset de contrase√±a</span> <span class="cm-pill">Email verificado</span></p></div><h2 id="v31-40-img">4.2 Imagen del resultado</h2><p class="cm-caption">La parte de autenticaci√≥n pasa de algo b√°sico a tener login y registro completos, con flujo de recuperaci√≥n y verificaci√≥n de correo.</p><figure class="post__image"><img loading="lazy" src="./media/posts/7/3-turismo.png" alt="" width="2560" height="1288" sizes="(max-width: 48em) 100vw, 768px" srcset="./media/posts/7/responsive/3-turismo-xs.png 300w, ./media/posts/7/responsive/3-turismo-sm.png 480w, ./media/posts/7/responsive/3-turismo-md.png 768w, ./media/posts/7/responsive/3-turismo-lg.png 1024w, ./media/posts/7/responsive/3-turismo-xl.png 1360w, ./media/posts/7/responsive/3-turismo-2xl.png 1600w"></figure><p>¬†</p><figure class="post__image"><img loading="lazy" src="./media/posts/7/4.png" alt="" width="1737" height="866" sizes="(max-width: 48em) 100vw, 768px" srcset="./media/posts/7/responsive/4-xs.png 300w, ./media/posts/7/responsive/4-sm.png 480w, ./media/posts/7/responsive/4-md.png 768w, ./media/posts/7/responsive/4-lg.png 1024w, ./media/posts/7/responsive/4-xl.png 1360w, ./media/posts/7/responsive/4-2xl.png 1600w"></figure><p>¬†</p><figure class="post__image"><img loading="lazy" src="./media/posts/7/5-agente-rrellena-sitios.png" alt="" width="1629" height="858" sizes="(max-width: 48em) 100vw, 768px" srcset="./media/posts/7/responsive/5-agente-rrellena-sitios-xs.png 300w, ./media/posts/7/responsive/5-agente-rrellena-sitios-sm.png 480w, ./media/posts/7/responsive/5-agente-rrellena-sitios-md.png 768w, ./media/posts/7/responsive/5-agente-rrellena-sitios-lg.png 1024w, ./media/posts/7/responsive/5-agente-rrellena-sitios-xl.png 1360w, ./media/posts/7/responsive/5-agente-rrellena-sitios-2xl.png 1600w"></figure><p>¬†</p><p>no funciono</p><p>¬†</p><figure class="post__image"><img loading="lazy" src="./media/posts/7/5.png" alt="" width="1743" height="333" sizes="(max-width: 48em) 100vw, 768px" srcset="./media/posts/7/responsive/5-xs.png 300w, ./media/posts/7/responsive/5-sm.png 480w, ./media/posts/7/responsive/5-md.png 768w, ./media/posts/7/responsive/5-lg.png 1024w, ./media/posts/7/responsive/5-xl.png 1360w, ./media/posts/7/responsive/5-2xl.png 1600w"></figure><p>¬†</p><figure class="post__image"><img loading="lazy" src="./media/posts/7/7agente-configura-fire-Storage.png" alt="" width="1656" height="855" sizes="(max-width: 48em) 100vw, 768px" srcset="./media/posts/7/responsive/7agente-configura-fire-Storage-xs.png 300w, ./media/posts/7/responsive/7agente-configura-fire-Storage-sm.png 480w, ./media/posts/7/responsive/7agente-configura-fire-Storage-md.png 768w, ./media/posts/7/responsive/7agente-configura-fire-Storage-lg.png 1024w, ./media/posts/7/responsive/7agente-configura-fire-Storage-xl.png 1360w, ./media/posts/7/responsive/7agente-configura-fire-Storage-2xl.png 1600w"></figure><p>¬†</p><h1 id="v41-48">5. Versiones 41‚Äì48+: autenticaci√≥n ‚Äì avanzado y pulido final</h1><h2 id="v41-48-prompts">5.1 Resumen de prompts</h2><div class="cm-block"><ul class="cm-list"><li>Mejora del formulario de <strong>cambio de contrase√±a</strong> con reautenticaci√≥n, indicador de fortaleza y feedback claro para el usuario.</li><li>Posibilidad de <strong>cambiar el email</strong> del usuario, con reautenticaci√≥n y verificaci√≥n del nuevo correo antes de darlo por bueno.</li><li>Bot√≥n para <strong>cerrar sesi√≥n en todos los dispositivos</strong>, dejando claro qu√© va a pasar y mostrando mensajes de √©xito o error.</li><li>Flujo de <strong>eliminar cuenta</strong> en dos pasos, con advertencias serias y borrado de datos asociados en Firestore/Storage donde aplique.</li><li>Implementaci√≥n de <strong>timeout por inactividad</strong> con aviso previo al usuario y cierre de sesi√≥n autom√°tico pasado el tiempo configurado.</li><li>Correcci√≥n del login con Google, pasando de <code>signInWithPopup</code> a <code>signInWithRedirect</code> + <code>getRedirectResult</code>, y mejora de estados de carga, accesibilidad y dise√±o responsive.</li><li>Propuesta de una estructura organizada tipo <code>authFunctions</code>, checklist de verificaci√≥n y definici√≥n de navegadores soportados y configuraci√≥n necesaria en Firebase Console.</li></ul><figure class="post__image"><span class="cm-pill">Gesti√≥n de cuenta</span> <span class="cm-pill">Eliminar cuenta</span> <span class="cm-pill">Timeout de sesi√≥n</span> <span class="cm-pill">Login con Google</span> <span class="cm-pill">Checklist de auth</span><img loading="lazy" style="font-size: inherit; outline: rgba(13, 139, 242, 0.55) solid 3px !important;" src="./media/posts/7/9.-estetica.png" alt="" width="2019" height="1188" sizes="(max-width: 48em) 100vw, 768px" srcset="./media/posts/7/responsive/9.-estetica-xs.png 300w, ./media/posts/7/responsive/9.-estetica-sm.png 480w, ./media/posts/7/responsive/9.-estetica-md.png 768w, ./media/posts/7/responsive/9.-estetica-lg.png 1024w, ./media/posts/7/responsive/9.-estetica-xl.png 1360w, ./media/posts/7/responsive/9.-estetica-2xl.png 1600w"></figure></div><h2 id="v41-48-img">5.2 Imagen del resultado</h2><p class="cm-caption">El sistema de autenticaci√≥n queda redondo: gestionas contrase√±a, email, sesiones e incluso la eliminaci√≥n de la cuenta, con una estructura de c√≥digo m√°s limpia.</p><div class="cm-block"><p class="hint" style="margin: 0;">Tip: si en el futuro a√±ades m√°s paquetes de versi√≥n, puedes copiar uno de estos bloques, cambiar los t√≠tulos y actualizar la lista de cambios.</p><p>¬†</p><figure class="post__image"><img loading="lazy" src="./media/posts/7/2025-11-20-14-30-54.png" alt="" width="2548" height="1267" sizes="(max-width: 48em) 100vw, 768px" srcset="./media/posts/7/responsive/2025-11-20-14-30-54-xs.png 300w, ./media/posts/7/responsive/2025-11-20-14-30-54-sm.png 480w, ./media/posts/7/responsive/2025-11-20-14-30-54-md.png 768w, ./media/posts/7/responsive/2025-11-20-14-30-54-lg.png 1024w, ./media/posts/7/responsive/2025-11-20-14-30-54-xl.png 1360w, ./media/posts/7/responsive/2025-11-20-14-30-54-2xl.png 1600w"></figure></div></div></article></main><footer id="copyright"><p>¬© Daniel Terroba Alcala<br><br></p></footer></div><script src="./assets/js/jquery.min.js?v=c9771cc3e90e18f5336eedbd0fffb2cf"></script><script src="./assets/js/jquery.scrollex.min.js?v=f89065e3d988006af9791b44561d7c90"></script><script src="./assets/js/jquery.scrolly.min.js?v=1ed5a78bde1476875a40f6b9ff44fc14"></script><script src="./assets/js/browser.min.js?v=c07298dd19048a8a69ad97e754dfe8d0"></script><script src="./assets/js/breakpoints.min.js?v=81a479eb099e3b187613943b085923b8"></script><script src="./assets/js/util.min.js?v=4201a626f8c9b614a663b3a1d7d82615"></script><script src="./assets/js/main.min.js?v=56233c354bd814758be8bff42f7e13a5"></script><script>/*<![CDATA[*/var images=document.querySelectorAll("img[loading]");for(var i=0;i<images.length;i++){if(images[i].complete){images[i].classList.add("is-loaded")}else{images[i].addEventListener("load",function(){this.classList.add("is-loaded")},false)}};/*]]>*/</script></body></html>